<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="러브스토리 어드벤처 - 대학생 연애 시뮬레이션 게임">
  <title>러브스토리 어드벤처</title>
  
  <style>
    /* CSS 변수 정의 */
    :root {
      --primary-bg: #0f0f1e;
      --container-bg: #1a1a2e;
      --text-color: #e8e8e8;
      --choice-bg: #2d2d44;
      --choice-hover: #3d3d5c;
      --status-color: #a8a8b8;
      --affection-color: #ff6b9d;
      --container-width: min(900px, 95vw);
    }

    /* 전역 리셋 */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* 바디 스타일 */
    body {
      background: linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 50%, #16213e 100%);
      color: var(--text-color);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    /* 게임 컨테이너 */
    #game-container {
      width: var(--container-width);
      background: rgba(26, 26, 46, 0.95);
      backdrop-filter: blur(10px);
      padding: 35px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      position: relative;
      z-index: 1;
      animation: fadeIn 0.8s ease-out;
    }

    @keyframes fadeIn {
      from { 
        opacity: 0; 
        transform: translateY(20px);
      }
      to { 
        opacity: 1; 
        transform: translateY(0);
      }
    }

    /* 컨트롤 버튼 */
    #control-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .control-btn {
      padding: 8px 14px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      color: var(--text-color);
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }

    .control-btn:hover {
      background: rgba(255,255,255,0.1);
      transform: translateY(-1px);
    }

    /* 씬 정보 */
    #scene-info {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      font-size: 13px;
      color: var(--status-color);
      flex-wrap: wrap;
      justify-content: center;
    }

    .scene-tag {
      padding: 4px 10px;
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    /* 텍스트 컨테이너 */
    #text-container {
      min-height: 200px;
      margin-bottom: 25px;
      padding: 25px;
      background: rgba(0,0,0,0.2);
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.05);
    }

    #character-name {
      font-size: 14px;
      color: var(--affection-color);
      margin-bottom: 10px;
      font-weight: 600;
    }

    #text {
      font-size: 18px;
      line-height: 1.7;
      white-space: pre-line;
      word-wrap: break-word;
    }

    .typing-cursor::after {
      content: '▋';
      animation: blink 1s infinite;
      color: var(--affection-color);
      opacity: 0.7;
    }

    @keyframes blink {
      0%, 49% { opacity: 0.7; }
      50%, 100% { opacity: 0; }
    }

    /* 선택지 */
    #choices {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .choice {
      padding: 14px 20px;
      background: var(--choice-bg);
      border: 2px solid transparent;
      border-radius: 12px;
      color: var(--text-color);
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-family: inherit;
      animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .choice:hover {
      background: var(--choice-hover);
      transform: translateX(5px);
      border-color: rgba(102, 126, 234, 0.3);
    }

    .choice:active {
      transform: scale(0.98);
    }

    .choice-tone {
      font-size: 20px;
      opacity: 0.7;
    }

    /* 호감도 바 */
    #affection-container {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: rgba(255,107,157,0.05);
      border-radius: 12px;
      border: 1px solid rgba(255,107,157,0.2);
      margin-top: 20px;
    }

    #affection-icon {
      font-size: 24px;
      animation: heartbeat 2s infinite;
    }

    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      10%, 30% { transform: scale(1.1); }
      20% { transform: scale(1.05); }
    }

    #affection-bar {
      flex: 1;
      height: 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 5px;
      overflow: hidden;
    }

    #affection-fill {
      height: 100%;
      background: linear-gradient(90deg, #ff6b9d, #ff8787);
      transition: width 0.8s ease;
    }

    #affection-value {
      font-size: 16px;
      font-weight: bold;
      min-width: 60px;
      text-align: center;
    }

    /* 알림 */
    .notification {
      position: fixed;
      top: 30px;
      right: 30px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      padding: 15px 20px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      animation: notificationSlide 0.5s ease-out;
      z-index: 1000;
      color: white;
      font-size: 14px;
      max-width: 300px;
    }

    @keyframes notificationSlide {
      from { 
        transform: translateX(400px);
        opacity: 0;
      }
      to { 
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* 로딩 화면 */
    #loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--primary-bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    .loader {
      width: 60px;
      height: 60px;
      border: 3px solid rgba(255,255,255,0.1);
      border-top-color: var(--affection-color);
      border-radius: 50%;
      animation: spin 1s infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* 반응형 */
    @media (max-width: 768px) {
      #game-container {
        padding: 20px;
        border-radius: 0;
        width: 100%;
        min-height: 100vh;
      }
      
      #text {
        font-size: 16px;
      }
      
      .choice {
        font-size: 14px;
        padding: 12px 16px;
      }
      
      .notification {
        right: 10px;
        left: 10px;
        max-width: calc(100% - 20px);
      }
    }
  </style>
</head>
<body>
  <!-- 로딩 화면 -->
  <div id="loading">
    <div class="loader"></div>
    <p style="margin-top: 20px; color: #a8a8b8;">게임을 준비하는 중...</p>
  </div>

  <!-- 게임 컨테이너 -->
  <div id="game-container" style="display: none;">
    <!-- 컨트롤 버튼 -->
    <div id="control-buttons">
      <button class="control-btn" onclick="game.saveGame()">💾 저장</button>
      <button class="control-btn" onclick="game.loadGame()">📁 불러오기</button>
      <button class="control-btn" onclick="game.resetGame()">🔄 초기화</button>
    </div>

    <!-- 씬 정보 -->
    <div id="scene-info">
      <span class="scene-tag">📍 <span id="location">대학교</span></span>
      <span class="scene-tag">🕐 <span id="time">오후</span></span>
    </div>

    <!-- 텍스트 영역 -->
    <div id="text-container">
      <div id="character-name" style="display: none;"></div>
      <div id="text">게임을 시작하는 중...</div>
    </div>
    
    <!-- 선택지 영역 -->
    <div id="choices"></div>
    
    <!-- 호감도 표시 -->
    <div id="affection-container">
      <span id="affection-icon">💕</span>
      <div id="affection-bar">
        <div id="affection-fill" style="width: 10%"></div>
      </div>
      <span id="affection-value">1/10</span>
    </div>
  </div>

  <script>
    // ==========================================
    // 시나리오 데이터 (완전한 버전)
    // ==========================================
    const SCENARIO_DATA = {
      "start": {
        "location": "대학교 도서관",
        "time": "오후 3시",
        "character": "미나",
        "text": "조용한 도서관, 창문으로 들어오는 따스한 햇살이 책상을 비추고 있다.\n\n시험공부에 집중하던 중, 맞은편 자리에 누군가 앉는 소리가 들린다.\n고개를 들어보니 같은 수업을 듣는 미나가 수줍게 웃으며 인사한다.\n\n\"안녕? 여기 앉아도 될까?\"",
        "choices": [
          {
            "text": "물론이지! 같이 공부하면 더 좋지.",
            "tone": "😊",
            "next": "friendly_start",
            "affection": 2
          },
          {
            "text": "응, 앉아도 돼.",
            "tone": "😐",
            "next": "neutral_start",
            "affection": 0
          },
          {
            "text": "... (그냥 고개만 끄덕인다)",
            "tone": "😶",
            "next": "cold_start",
            "affection": -1
          }
        ]
      },
      
      "friendly_start": {
        "location": "대학교 도서관",
        "time": "오후 3시 30분",
        "character": "미나",
        "text": "미나의 얼굴이 환하게 밝아진다.\n\n\"고마워! 사실 이 과목 너무 어려워서 혼자 공부하기 막막했거든.\"\n\n그녀가 가방에서 노트를 꺼내며 말을 이어간다.\n\"혹시 3장 내용 이해했어? 교수님 설명이 너무 빨라서...\"",
        "choices": [
          {
            "text": "내 노트 같이 보면서 설명해줄게!",
            "tone": "🤝",
            "next": "study_together",
            "affection": 2
          },
          {
            "text": "나도 잘 모르겠어. 같이 다시 읽어볼까?",
            "tone": "📚",
            "next": "study_together",
            "affection": 1
          }
        ]
      },
      
      "neutral_start": {
        "location": "대학교 도서관",
        "time": "오후 3시 30분",
        "character": "미나",
        "text": "미나가 조용히 자리에 앉는다.\n\n잠시 어색한 침묵이 흐른 후, 그녀가 작은 목소리로 말한다.\n\n\"저... 혹시 이번 주 과제 했어? 문제 3번이 너무 어려워서...\"",
        "choices": [
          {
            "text": "아, 그거? 어제 겨우 풀었어. 도와줄까?",
            "tone": "😊",
            "next": "help_homework",
            "affection": 2
          },
          {
            "text": "응, 했어. 교재 예제 참고하면 돼.",
            "tone": "💡",
            "next": "give_hint",
            "affection": 0
          }
        ]
      },
      
      "cold_start": {
        "location": "대학교 도서관",
        "time": "오후 3시 30분",
        "character": "미나",
        "text": "미나가 어색하게 자리에 앉으며 작게 한숨을 쉰다.\n\n그녀는 조용히 책을 펴고 공부를 시작한다.\n하지만 가끔씩 도움이 필요한 듯 이쪽을 힐끔거린다.\n\n30분쯤 지났을까, 그녀가 일어나려는 것이 보인다.",
        "choices": [
          {
            "text": "어... 벌써 가? 내가 불편하게 했다면 미안해.",
            "tone": "😰",
            "next": "apologize",
            "affection": 1
          },
          {
            "text": "(아무 말 없이 계속 공부한다)",
            "tone": "😑",
            "next": "bad_ending",
            "affection": -2
          }
        ]
      },
      
      "study_together": {
        "location": "대학교 도서관",
        "time": "오후 5시",
        "character": "미나",
        "text": "두 시간 동안 함께 공부한 끝에, 어려웠던 부분들이 하나씩 이해되기 시작한다.\n\n미나가 밝게 웃으며 기지개를 켠다.\n\"와, 덕분에 정말 많이 이해했어! 너 설명 진짜 잘한다.\"\n\n\"배고프지 않아? 같이 학식 먹으러 갈래?\"",
        "choices": [
          {
            "text": "좋아! 오늘은 내가 살게.",
            "tone": "🍽️",
            "next": "dinner_together",
            "affection": 3
          },
          {
            "text": "그래, 같이 가자!",
            "tone": "😄",
            "next": "dinner_together",
            "affection": 1
          }
        ]
      },
      
      "help_homework": {
        "location": "대학교 도서관",
        "time": "오후 4시",
        "character": "미나",
        "text": "미나의 얼굴이 밝아진다.\n\n\"정말? 고마워! 이렇게 친절한 사람은 처음이야.\"\n\n함께 문제를 풀어가며 점점 가까워지는 것을 느낀다.\n그녀가 수줍게 웃으며 말한다.\n\n\"너랑 공부하니까 훨씬 재밌네. 다음에도 같이 공부할래?\"",
        "choices": [
          {
            "text": "당연하지! 언제든지 좋아.",
            "tone": "💕",
            "next": "promise_study",
            "affection": 2
          },
          {
            "text": "응, 시간 맞으면 같이하자.",
            "tone": "📅",
            "next": "casual_promise",
            "affection": 1
          }
        ]
      },
      
      "give_hint": {
        "location": "대학교 도서관",
        "time": "오후 4시",
        "character": "미나",
        "text": "미나가 고개를 끄덕이며 교재를 펼친다.\n\n\"아, 그래? 한 번 찾아볼게. 고마워.\"\n\n그녀는 조용히 공부를 시작한다.\n잠시 후 미나가 다시 말을 건다.\n\n\"혹시... 같이 공부할래? 혼자보다는 나을 것 같아서.\"",
        "choices": [
          {
            "text": "좋아, 같이 하자!",
            "tone": "😊",
            "next": "study_together",
            "affection": 1
          },
          {
            "text": "미안, 나는 혼자가 편해서...",
            "tone": "😔",
            "next": "study_alone",
            "affection": -1
          }
        ]
      },
      
      "apologize": {
        "location": "대학교 도서관",
        "time": "오후 4시",
        "character": "미나",
        "text": "미나가 멈춰서서 돌아본다.\n\n\"아니야, 네가 미안할 건 없어. 나도 갑자기 와서...\"\n\n그녀가 다시 자리에 앉는다.\n\"사실 같이 공부하고 싶었거든. 혼자는 너무 막막해서.\"\n\n\"같이 해도 될까?\"",
        "choices": [
          {
            "text": "그럼 같이 하자! 나도 도움이 필요했어.",
            "tone": "😊",
            "next": "study_together",
            "affection": 2
          },
          {
            "text": "알겠어. 조용히 하자.",
            "tone": "🤫",
            "next": "study_quietly",
            "affection": 0
          }
        ]
      },
      
      "dinner_together": {
        "location": "학생 식당",
        "time": "오후 6시",
        "character": "미나",
        "text": "학생 식당으로 걸어가는 길, 저녁노을이 캠퍼스를 황금빛으로 물들인다.\n\n미나가 수줍게 웃으며 말한다.\n\"있잖아... 사실 너한테 하고 싶은 말이 있어.\"\n\n그녀가 잠시 망설이다가 용기를 낸다.\n\"우리... 앞으로도 자주 만날 수 있을까?\"",
        "choices": [
          {
            "text": "나도 너랑 더 친해지고 싶었어.",
            "tone": "💕",
            "next": "good_ending",
            "affection": 3
          },
          {
            "text": "응, 좋은 친구가 될 수 있을 것 같아.",
            "tone": "🤝",
            "next": "friend_ending",
            "affection": 1
          }
        ]
      },
      
      "promise_study": {
        "location": "대학교 도서관",
        "time": "오후 5시",
        "character": "미나",
        "text": "미나가 환하게 웃는다.\n\n\"약속이야! 내일도 같은 시간에 여기서 만나자.\"\n\n그녀가 가방을 챙기며 덧붙인다.\n\"커피 사올게. 네가 좋아하는 거 뭐야?\"\n\n\"우리 정말 좋은 친구가 될 수 있을 것 같아!\"",
        "choices": [
          {
            "text": "나도 그렇게 생각해. 내일 봐!",
            "tone": "😊",
            "next": "promise_ending",
            "affection": 2
          }
        ]
      },
      
      "casual_promise": {
        "location": "대학교 도서관",
        "time": "오후 5시",
        "character": "미나",
        "text": "미나가 고개를 끄덕인다.\n\n\"그래, 부담 갖지 말고 편하게 만나자.\"\n\n서로 연락처를 교환한다.\n\"그럼 연락할게. 오늘 고마웠어!\"",
        "choices": [
          {
            "text": "응, 나도 고마웠어. 조심히 가!",
            "tone": "👋",
            "next": "casual_ending",
            "affection": 1
          }
        ]
      },
      
      "study_quietly": {
        "location": "대학교 도서관",
        "time": "오후 5시",
        "character": "미나",
        "text": "조용한 시간이 흐른다.\n\n가끔 서로 눈이 마주치면 작게 미소를 짓는다.\n해가 지고 도서관이 어두워질 무렵, 미나가 일어선다.\n\n\"수고했어. 덕분에 집중이 잘 됐어. 또 봐!\"",
        "choices": [
          {
            "text": "응, 수고했어. 다음에 또 만나자.",
            "tone": "😊",
            "next": "neutral_ending",
            "affection": 1
          }
        ]
      },
      
      "study_alone": {
        "location": "대학교 도서관",
        "time": "오후 5시",
        "character": "미나",
        "text": "미나가 실망한 표정을 감추며 고개를 끄덕인다.\n\n\"아... 알겠어. 방해해서 미안해.\"\n\n그녀는 조용히 자리로 돌아간다.\n잠시 후 미나가 짐을 챙겨 도서관을 떠난다.",
        "choices": [
          {
            "text": "(아쉬움이 남는다...)",
            "tone": "😔",
            "next": "regret_ending",
            "affection": 0
          }
        ]
      },
      
      // ========== 엔딩 장면들 ==========
      "good_ending": {
        "location": "캠퍼스 벤치",
        "time": "저녁",
        "character": "미나",
        "text": "미나의 얼굴이 저녁노을처럼 붉게 물든다.\n\n\"정말? 사실... 나도 그래. 처음 만났을 때부터 네가 신경 쓰였어.\"\n\n그녀가 당신의 손을 살짝 잡는다.\n\"우리... 이제 친구 이상이 될 수 있을까?\"\n\n💕 해피 엔딩 - 새로운 시작 💕\n호감도 최대치 달성!",
        "ending": true,
        "choices": [
          {
            "text": "처음부터 다시 시작하기",
            "tone": "🔄",
            "next": "start",
            "reset": true
          }
        ]
      },
      
      "bad_ending": {
        "location": "대학교 도서관",
        "time": "오후 4시",
        "character": "",
        "text": "미나가 조용히 짐을 챙기며 일어선다.\n\n그녀가 떠나간 자리에는 아쉬움만 남는다.\n어쩌면 좋은 인연이 될 수 있었을지도...\n\n😢 배드 엔딩 - 놓친 기회 😢",
        "ending": true,
        "choices": [
          {
            "text": "처음부터 다시 시작하기",
            "tone": "🔄",
            "next": "start",
            "reset": true
          }
        ]
      },
      
      "regret_ending": {
        "location": "대학교 도서관",
        "time": "저녁",
        "character": "",
        "text": "혼자 남은 도서관.\n\n왜 그렇게 차갑게 대했을까...\n후회가 밀려온다.\n\n😔 배드 엔딩 - 후회 😔",
        "ending": true,
        "choices": [
          {
            "text": "처음부터 다시 시작하기",
            "tone": "🔄",
            "next": "start",
            "reset": true
          }
        ]
      }
    };

    // ==========================================
    // 게임 엔진 클래스
    // ==========================================
    class AdventureGame {
      constructor() {
        this.currentScene = 'start';
        this.affection = 1;
        this.maxAffection = 10;
        this.history = [];
        this.typingSpeed = 25;
        this.typingTimer = null;
        this.skipMode = false;
      }

      init() {
        // 로딩 화면 숨기기
        setTimeout(() => {
          const loading = document.getElementById('loading');
          loading.style.opacity = '0';
          setTimeout(() => {
            loading.style.display = 'none';
            document.getElementById('game-container').style.display = 'block';
            this.showScene(this.currentScene);
          }, 500);
        }, 1000);
      }

      showScene(sceneId) {
        const scene = SCENARIO_DATA[sceneId];
        if (!scene) {
          console.error('Scene not found:', sceneId);
          this.showNotification('장면을 찾을 수 없습니다!', '❌');
          return;
        }

        this.currentScene = sceneId;
        
        // 씬 정보 업데이트
        if (scene.location) {
          document.getElementById('location').textContent = scene.location;
        }
        if (scene.time) {
          document.getElementById('time').textContent = scene.time;
        }
        
        // 캐릭터 이름 표시
        const charName = document.getElementById('character-name');
        if (scene.character && scene.character !== "") {
          charName.textContent = scene.character;
          charName.style.display = 'block';
        } else {
          charName.style.display = 'none';
        }
        
        // 텍스트 타이핑 효과
        this.typeWriter(scene.text, () => {
          this.showChoices(scene.choices);
        });
      }

      typeWriter(text, callback) {
        const textElement = document.getElementById('text');
        textElement.innerHTML = '';
        textElement.classList.add('typing-cursor');
        
        if (this.typingTimer) {
          clearTimeout(this.typingTimer);
        }
        
        // 스킵 모드일 때는 즉시 표시
        if (this.skipMode) {
          textElement.innerHTML = text.replace(/\n/g, '<br>');
          textElement.classList.remove('typing-cursor');
          if (callback) callback();
          return;
        }
        
        let i = 0;
        const type = () => {
          if (i < text.length) {
            if (text.charAt(i) === '\n') {
              textElement.innerHTML += '<br>';
            } else {
              textElement.innerHTML += text.charAt(i);
            }
            i++;
            this.typingTimer = setTimeout(type, this.typingSpeed);
          } else {
            textElement.classList.remove('typing-cursor');
            if (callback) callback();
          }
        };
        type();
      }

      showChoices(choices) {
        const choicesElement = document.getElementById('choices');
        choicesElement.innerHTML = '';
        
        choices.forEach((choice, index) => {
          const button = document.createElement('button');
          button.className = 'choice';
          
          const textSpan = document.createElement('span');
          textSpan.textContent = choice.text;
          button.appendChild(textSpan);
          
          if (choice.tone) {
            const toneSpan = document.createElement('span');
            toneSpan.className = 'choice-tone';
            toneSpan.textContent = choice.tone;
            button.appendChild(toneSpan);
          }
          
          button.onclick = () => this.selectChoice(choice);
          
          // 애니메이션을 위한 지연
          button.style.animationDelay = `${index * 0.1}s`;
          
          choicesElement.appendChild(button);
        });
      }

      selectChoice(choice) {
        // 히스토리 저장
        this.history.push({
          scene: this.currentScene,
          choice: choice.text,
          timestamp: Date.now()
        });
        
        // 호감도 업데이트
        if (choice.affection !== undefined) {
          this.updateAffection(choice.affection);
        }
        
        // 리셋 처리
        if (choice.reset) {
          this.reset();
        }
        
        // 다음 씬으로
        this.showScene(choice.next);
      }

      updateAffection(delta) {
        const oldAffection = this.affection;
        this.affection = Math.max(1, Math.min(this.maxAffection, this.affection + delta));
        
        // UI 업데이트
        const fill = document.getElementById('affection-fill');
        const value = document.getElementById('affection-value');
        const percentage = (this.affection / this.maxAffection) * 100;
        
        fill.style.width = percentage + '%';
        value.textContent = `${this.affection}/${this.maxAffection}`;
        
        // 호감도 변화 알림
        if (delta !== 0) {
          const emoji = delta > 0 ? '💕' : '💔';
          const text = delta > 0 ? `호감도 +${delta}` : `호감도 ${delta}`;
          this.showNotification(text, emoji);
        }
      }

      showNotification(text, emoji = '📢') {
        // 기존 알림 제거
        const existing = document.querySelector('.notification');
        if (existing) existing.remove();
        
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.innerHTML = `<span style="font-size: 20px;">${emoji}</span> ${text}`;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.opacity = '0';
          notification.style.transform = 'translateX(400px)';
          setTimeout(() => notification.remove(), 500);
        }, 2000);
      }

      saveGame() {
        const saveData = {
          currentScene: this.currentScene,
          affection: this.affection,
          history: this.history,
          timestamp: Date.now()
        };
        
        try {
          localStorage.setItem('adventureGameSave', JSON.stringify(saveData));
          this.showNotification('게임이 저장되었습니다!', '💾');
        } catch (e) {
          console.error('Save failed:', e);
          this.showNotification('저장 실패!', '❌');
        }
      }

      loadGame() {
        try {
          const saveData = localStorage.getItem('adventureGameSave');
          if (saveData) {
            const data = JSON.parse(saveData);
            this.currentScene = data.currentScene;
            this.affection = data.affection;
            this.history = data.history || [];
            
            // UI 업데이트
            const fill = document.getElementById('affection-fill');
            const value = document.getElementById('affection-value');
            const percentage = (this.affection / this.maxAffection) * 100;
            fill.style.width = percentage + '%';
            value.textContent = `${this.affection}/${this.maxAffection}`;
            
            this.showScene(this.currentScene);
            this.showNotification('게임을 불러왔습니다!', '📁');
          } else {
            this.showNotification('저장된 게임이 없습니다.', '❌');
          }
        } catch (e) {
          console.error('Load failed:', e);
          this.showNotification('불러오기 실패!', '❌');
        }
      }

      resetGame() {
        if (confirm('정말로 게임을 초기화하시겠습니까?\n모든 진행 상황이 삭제됩니다.')) {
          this.reset();
          this.showScene(this.currentScene);
          this.showNotification('게임이 초기화되었습니다!', '🔄');
        }
      }

      reset() {
        this.currentScene = 'start';
        this.affection = 1;
        this.history = [];
        
        // UI 초기화
        const fill = document.getElementById('affection-fill');
        const value = document.getElementById('affection-value');
        fill.style.width = '10%';
        value.textContent = '1/10';
      }

      toggleSkip() {
        this.skipMode = !this.skipMode;
        this.showNotification(
          this.skipMode ? '스킵 모드 ON' : '스킵 모드 OFF',
          '⏩'
        );
      }
    }

    // ==========================================
    // 게임 시작
    // ==========================================
    const game = new AdventureGame();
    
    // DOM 로드 완료 후 초기화
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => game.init());
    } else {
      game.init();
    }

    // 키보드 단축키
    document.addEventListener('keydown', (e) => {
      // Ctrl/Cmd + 키
      if (e.ctrlKey || e.metaKey) {
        switch(e.key.toLowerCase()) {
          case 's':
            e.preventDefault();
            game.saveGame();
            break;
          case 'l':
            e.preventDefault();
            game.loadGame();
            break;
          case 'r':
            e.preventDefault();
            game.resetGame();
            break;
        }
      }
      // 스페이스바 - 스킵
      else if (e.key === ' ') {
        e.preventDefault();
        game.toggleSkip();
      }
    });

    // 페이지 나가기 전 확인
    window.addEventListener('beforeunload', (e) => {
      if (game.history.length > 0 && !game.currentScene.includes('ending')) {
        e.preventDefault();
        e.returnValue = '진행 중인 게임이 있습니다. 정말 나가시겠습니까?';
      }
    });

    // 모바일 터치 제스처 지원
    let touchStartX = 0;
    let touchStartTime = 0;
    
    document.addEventListener('touchstart', (e) => {
      touchStartX = e.touches[0].clientX;
      touchStartTime = Date.now();
    });

    document.addEventListener('touchend', (e) => {
      const touchEndX = e.changedTouches[0].clientX;
      const touchEndTime = Date.now();
      const diff = touchEndX - touchStartX;
      const timeDiff = touchEndTime - touchStartTime;
      
      // 빠른 스와이프만 인식 (500ms 이내)
      if (timeDiff < 500 && Math.abs(diff) > 100) {
        if (diff > 0) {
          // 오른쪽 스와이프 - 불러오기
          game.loadGame();
        } else {
          // 왼쪽 스와이프 - 저장
          game.saveGame();
        }
      }
    });

    // 콘솔 메시지
    console.log('%c🎮 러브스토리 어드벤처 게임', 'color: #ff6b9d; font-size: 20px; font-weight: bold;');
    console.log('%c버전 1.0 | 제작: Your Name', 'color: #a8a8b8;');
    console.log('%c단축키: Ctrl+S(저장), Ctrl+L(불러오기), Space(스킵)', 'color: #667eea;');
  </script>
</body>
</html>": "start",
            "reset": true
          }
        ]
      },
      
      "friend_ending": {
        "location": "학생 식당",
        "time": "저녁",
        "character": "미나",
        "text": "미나가 아쉬운 듯 웃으며 고개를 끄덕인다.\n\n\"그래, 좋은 친구가 되자.\"\n\n둘은 즐겁게 저녁을 먹으며 대화를 나눈다.\n앞으로도 좋은 친구로 지낼 수 있을 것 같다.\n\n😊 굿 엔딩 - 좋은 친구 😊",
        "ending": true,
        "choices": [
          {
            "text": "처음부터 다시 시작하기",
            "tone": "🔄",
            "next": "start",
            "reset": true
          }
        ]
      },
      
      "promise_ending": {
        "location": "대학교 도서관",
        "time": "오후 5시",
        "character": "미나",
        "text": "미나가 행복한 표정으로 손을 흔든다.\n\n\"내일 봐! 오늘 정말 즐거웠어.\"\n\n새로운 인연이 시작되는 것 같다.\n\n💝 굿 엔딩 - 약속된 내일 💝",
        "ending": true,
        "choices": [
          {
            "text": "처음부터 다시 시작하기",
            "tone": "🔄",
            "next": "start",
            "reset": true
          }
        ]
      },
      
      "casual_ending": {
        "location": "대학교",
        "time": "저녁",
        "character": "미나",
        "text": "미나가 밝게 웃으며 작별 인사를 한다.\n\n가끔씩 만날 수 있는 좋은 친구가 생겼다.\n\n📚 노멀 엔딩 - 스터디 메이트 📚",
        "ending": true,
        "choices": [
          {
            "text": "처음부터 다시 시작하기",
            "tone": "🔄",
            "next": "start",
            "reset": true
          }
        ]
      },
      
      "neutral_ending": {
        "location": "대학교 도서관",
        "time": "저녁",
        "character": "미나",
        "text": "평범한 하루가 끝났다.\n\n하지만 왠지 기분 좋은 만남이었다.\n\n📖 노멀 엔딩 - 평범한 하루 📖",
        "ending": true,
        "choices": [
          {
            "text": "처음부터 다시 시작하기",
            "tone": "🔄",
            "next